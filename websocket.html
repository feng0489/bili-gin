<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<input type="text" id="input">
<input type="hidden" id="line_id" value="2">
<button class="el-button el-button--primary el-button--large" type="button" onclick="say()"><span>发送消息</span></button>
</body>
</html>

<script>
    var uuid =  uuid();
    var ws = new WebSocket("ws://localhost:6619/connet");
    //连接打开时触发
    ws.onopen = function(evt) {
        console.log("Connection open ...");
        ws.send("Hello WebSockets!");};
    //接收到消息时触发
    ws.onmessage = function(evt) {
        console.log("Received Message: " + evt.data);};
    //连接关闭时触发
    ws.onclose = function(evt) {
        console.log("Connection closed.");};


    function say() {
        let t = document.getElementById('input').value || '1111';
        let line_id = document.getElementById('line_id').value || '1111';
        if (!t) return;
        var message = {};
        message.msg_type = line_id;
        message.uuid =uuid;
        message.msg =t;
        console.log(JSON.stringify(message))
        ws.send(JSON.stringify(message));
    }

    function uuid() {
        var s = [];
        var hexDigits = "0123456789abcdef";
        for (var i = 0; i < 36; i++) {
            s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
        }
        s[14] = "4";  // bits 12-15 of the time_hi_and_version field to 0010
        s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);  // bits 6-7 of the clock_seq_hi_and_reserved to 01
        s[8] = s[13] = s[18] = s[23] = "-";

        var uuid = s.join("");
        return uuid;
    }

</script>